{
  "actId": 4,
  "title": "Temporal Surgery",
  "description": "Rewrite history responsibly. Time manipulation feels dangerous.",
  "steps": [
    {
      "id": "story-1",
      "type": "dialog",
      "speaker": "SYSTEM",
      "text": "Timeline integrity compromised. History is fractured.",
      "speakerType": "system"
    },
    {
      "id": "story-2",
      "type": "dialog",
      "speaker": "Keif-X",
      "text": "The repo is stabilizing, but timelines are still fractured. We can fix this. We'll rewrite the timeline using rebase.",
      "speakerType": "character"
    },
    {
      "id": "story-3",
      "type": "dialog",
      "speaker": "BugLord",
      "text": "Hah! Enjoy your spaghetti graph. Impossible to read. Impossible to share.",
      "speakerType": "character"
    },
    {
      "id": "story-4",
      "type": "dialog",
      "speaker": "Keif-X",
      "text": "Rebase takes commits from one branch and replays them on top of another. Clean. Linear. Elegant.",
      "speakerType": "character"
    },
    {
      "id": "terminal-checkout",
      "type": "terminal",
      "title": "Switch to Feature Branch",
      "initialOutput": [
        { "type": "output", "text": "Timeline is fractured. History is messy." },
        { "type": "output", "text": "Let's rebase the feature branch onto main for a clean history." },
        { "type": "output", "text": "" }
      ],
      "expectedCommand": "git checkout feature/login",
      "commandPattern": "^git checkout feature/login$",
      "suggestions": [
        { "command": "git checkout feature/login", "hint": "Switch to feature branch" }
      ],
      "successOutput": [
        { "type": "success", "text": "Switched to branch 'feature/login'" },
        { "type": "output", "text": "" }
      ],
      "errorOutput": [
        { "type": "error", "text": "Command not recognized or not expected at this step." },
        { "type": "output", "text": "Check the suggestions above." },
        { "type": "output", "text": "" }
      ],
      "nextStep": "terminal-rebase"
    },
    {
      "id": "terminal-rebase",
      "type": "terminal",
      "title": "Rebase onto Main",
      "expectedCommand": "git rebase main",
      "commandPattern": "^git rebase main$",
      "suggestions": [
        { "command": "git rebase main", "hint": "Rebase onto main" }
      ],
      "successOutput": [
        { "type": "output", "text": "$ git rebase main" },
        { "type": "output", "text": "First, rewinding head to replay your work on top of it..." },
        { "type": "output", "text": "" },
        { "type": "output", "text": "Applying: Add login feature (C)" },
        { "type": "success", "text": "âœ“ Commit C replayed" },
        { "type": "output", "text": "" },
        { "type": "output", "text": "Applying: Add authentication (D)" },
        { "type": "success", "text": "âœ“ Commit D replayed" },
        { "type": "output", "text": "" },
        { "type": "success", "text": "Successfully rebased and updated refs/heads/feature/login" },
        { "type": "output", "text": "" },
        { "type": "success", "text": "ðŸ’¡ Concept: Rebase replays commits to create a linear history." },
        { "type": "output", "text": "   The commits get new IDs but the changes are the same." },
        { "type": "output", "text": "   Never rebase public branches - it rewrites history!" },
        { "type": "output", "text": "" },
        { "type": "success", "text": "ðŸŽ‰ Rebase completed! History is now linear." },
        { "type": "output", "text": "" }
      ],
      "visualEvent": "timeline.rebase",
      "soundEvent": "rebase",
      "errorOutput": [
        { "type": "error", "text": "Command not recognized or not expected at this step." },
        { "type": "output", "text": "Check the suggestions above." },
        { "type": "output", "text": "" }
      ],
      "conceptId": "git rebase",
      "nextStep": "boss-interrupt-1"
    },
    {
      "id": "boss-interrupt-1",
      "type": "dialog",
      "speaker": "BugLord",
      "text": "You dare rewrite the past? One mistake erases existence.",
      "speakerType": "character",
      "nextStep": "concept-git-rebase"
    },
    {
      "id": "concept-git-rebase",
      "type": "concept",
      "conceptId": "git rebase",
      "autoShow": true,
      "nextStep": "story-end"
    },
    {
      "id": "story-end",
      "type": "dialog",
      "speaker": "Keif-X",
      "text": "History restored. Prepare for extraction mission.",
      "speakerType": "character",
      "nextStep": "complete"
    },
    {
      "id": "complete",
      "type": "complete",
      "message": "Act 4 Complete! You've mastered rebasing for clean history.",
      "nextAct": 5
    }
  ]
}
